<template>
    <div>
        <div class="container">
            <div class="handle-box">
                <el-upload
                    action="#"
                    :limit="1"
                    accept=".xlsx, .xls"
                    :show-file-list="false"
                    :before-upload="beforeUpload"
                    :http-request="handleMany"
                >
                    <el-button class="mr10" type="success">批量导入</el-button>
                </el-upload>
                <el-link href="/template.xlsx" target="_blank">下载模板</el-link>
            </div>
            <el-table :data="tableData" border class="table" header-cell-class-name="table-header">
                <el-table-column prop="col_0" label="序号" width="55" align="center"></el-table-column>
                <el-table-column prop="col_1" label="摘要"></el-table-column>
                <el-table-column prop="col_2" label="币别"></el-table-column>
                <el-table-column prop="col_3" label="钞汇"></el-table-column>
                <el-table-column prop="col_4" label="交易日期"></el-table-column>
                <el-table-column prop="col_5" label="交易金额"></el-table-column>
                <el-table-column prop="col_6" label="账户余额"></el-table-column>
                <el-table-column prop="col_7" label="交易地点/附言"></el-table-column>
                <el-table-column prop="col_8" label="对方账号与用户名"></el-table-column>
            </el-table>
        </div>
    </div>
</template>

<script setup lang="ts" name="import">
import { UploadProps } from 'element-plus';
import { ref, reactive } from 'vue';
import * as XLSX from 'xlsx';

interface TableItem {
    id: number;
    name: string;
    sno: string;
    class: string;
    age: string;
    sex: string;
}

const tableData = ref<TableItem[]>([]);
// 获取表格数据
const getData = () => {
    tableData.value =[
        {
            "col_0": "1",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220713",
            "col_5": "-30",
            "col_6": "123580591.72",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "2",
            "col_1": "支付机构提现",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220716",
            "col_5": "1000.00",
            "col_6": "123581591.72",
            "col_7": "微*****现",
            "col_8": "2*****司"
        },
        {
            "col_0": "3",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220716",
            "col_5": "-750",
            "col_6": "123580841.72",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "4",
            "col_1": "电子汇入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220805",
            "col_5": "3000.00",
            "col_6": "123583841.72",
            "col_7": "电*****入",
            "col_8": "6*****星"
        },
        {
            "col_0": "5",
            "col_1": "短信服务费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220806",
            "col_5": "-2",
            "col_6": "123583839.72",
            "col_7": "短*****费",
            "col_8": "0*****0"
        },
        {
            "col_0": "6",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220806",
            "col_5": "-184",
            "col_6": "123583655.72",
            "col_7": "支*****肉",
            "col_8": "1*****肉"
        },
        {
            "col_0": "7",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220806",
            "col_5": "-163.6",
            "col_6": "123583492.12",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "8",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220806",
            "col_5": "-300",
            "col_6": "123583192.12",
            "col_7": "支*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "9",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220811",
            "col_5": "-2400.00",
            "col_6": "123580792.12",
            "col_7": "财*****户",
            "col_8": "1*****户"
        },
        {
            "col_0": "10",
            "col_1": "ATM存款",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220813",
            "col_5": "10000.00",
            "col_6": "123590792.12",
            "col_7": "建*****4",
            "col_8": "*****"
        },
        {
            "col_0": "11",
            "col_1": "ATM存款",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220813",
            "col_5": "6000.00",
            "col_6": "123596792.12",
            "col_7": "建*****4",
            "col_8": "*****"
        },
        {
            "col_0": "12",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220814",
            "col_5": "-5990.00",
            "col_6": "123590802.12",
            "col_7": "支*****学",
            "col_8": "1*****学"
        },
        {
            "col_0": "13",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220814",
            "col_5": "-5189.00",
            "col_6": "123585613.12",
            "col_7": "财*****户",
            "col_8": "1*****户"
        },
        {
            "col_0": "14",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220817",
            "col_5": "-1000.00",
            "col_6": "123584613.12",
            "col_7": "财*****账",
            "col_8": "1*****账"
        },
        {
            "col_0": "15",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220821",
            "col_5": "-152",
            "col_6": "123584461.12",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "16",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220824",
            "col_5": "-30",
            "col_6": "123584431.12",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "17",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220824",
            "col_5": "-6",
            "col_6": "123584425.12",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "18",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220830",
            "col_5": "-400",
            "col_6": "123584025.12",
            "col_7": "网*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "19",
            "col_1": "充值",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220901",
            "col_5": "-200",
            "col_6": "123583825.12",
            "col_7": "财*****户",
            "col_8": "1*****户"
        },
        {
            "col_0": "20",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220903",
            "col_5": "-4",
            "col_6": "123583821.12",
            "col_7": "支*****市",
            "col_8": "1*****市"
        },
        {
            "col_0": "21",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220903",
            "col_5": "-3.5",
            "col_6": "123583817.62",
            "col_7": "支*****华",
            "col_8": "1*****华"
        },
        {
            "col_0": "22",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220903",
            "col_5": "-3",
            "col_6": "123583814.62",
            "col_7": "支*****市",
            "col_8": "1*****市"
        },
        {
            "col_0": "23",
            "col_1": "短信服务费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220906",
            "col_5": "-2",
            "col_6": "123583812.62",
            "col_7": "短*****费",
            "col_8": "0*****0"
        },
        {
            "col_0": "24",
            "col_1": "电子汇入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220906",
            "col_5": "5000.00",
            "col_6": "123588812.62",
            "col_7": "电*****入",
            "col_8": "6*****星"
        },
        {
            "col_0": "25",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220906",
            "col_5": "-4",
            "col_6": "123588808.62",
            "col_7": "支*****市",
            "col_8": "1*****市"
        },
        {
            "col_0": "26",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220910",
            "col_5": "-140",
            "col_6": "123588668.62",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "27",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220910",
            "col_5": "-2",
            "col_6": "123588666.62",
            "col_7": "支*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "28",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220911",
            "col_5": "-132",
            "col_6": "123588534.62",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "29",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220911",
            "col_5": "-71",
            "col_6": "123588463.62",
            "col_7": "支*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "30",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220911",
            "col_5": "-13.5",
            "col_6": "123588450.12",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "31",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220912",
            "col_5": "-218.8",
            "col_6": "123588231.32",
            "col_7": "网*****务",
            "col_8": "1*****务"
        },
        {
            "col_0": "32",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220912",
            "col_5": "-200",
            "col_6": "123588031.32",
            "col_7": "财*****信",
            "col_8": "1*****信"
        },
        {
            "col_0": "33",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220913",
            "col_5": "-2000.00",
            "col_6": "123586031.32",
            "col_7": "财*****账",
            "col_8": "1*****账"
        },
        {
            "col_0": "34",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220915",
            "col_5": "-300",
            "col_6": "123585731.32",
            "col_7": "支*****d",
            "col_8": "1*****d"
        },
        {
            "col_0": "35",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220916",
            "col_5": "-7.9",
            "col_6": "123585723.42",
            "col_7": "支*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "36",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220917",
            "col_5": "-25",
            "col_6": "123585698.42",
            "col_7": "支*****学",
            "col_8": "1*****学"
        },
        {
            "col_0": "37",
            "col_1": "利息存入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220921",
            "col_5": "1.69",
            "col_6": "123585700.11",
            "col_7": "*****",
            "col_8": "*****"
        },
        {
            "col_0": "38",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220921",
            "col_5": "-30",
            "col_6": "123585670.11",
            "col_7": "支*****院",
            "col_8": "1*****院"
        },
        {
            "col_0": "39",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220923",
            "col_5": "-7.8",
            "col_6": "123585662.31",
            "col_7": "支*****宇",
            "col_8": "1*****宇"
        },
        {
            "col_0": "40",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220923",
            "col_5": "-5",
            "col_6": "123585657.31",
            "col_7": "支*****宇",
            "col_8": "1*****宇"
        },
        {
            "col_0": "41",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220924",
            "col_5": "-6",
            "col_6": "123585651.31",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "42",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220925",
            "col_5": "-3.8",
            "col_6": "123585647.51",
            "col_7": "支*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "43",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221002",
            "col_5": "-100",
            "col_6": "123585547.51",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "44",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221004",
            "col_5": "-30",
            "col_6": "123585517.51",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "45",
            "col_1": "短信服务费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221006",
            "col_5": "-2",
            "col_6": "123585515.51",
            "col_7": "账*****费",
            "col_8": "0*****0"
        },
        {
            "col_0": "46",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221006",
            "col_5": "-7.35",
            "col_6": "123585508.16",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "47",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221006",
            "col_5": "-58",
            "col_6": "123585450.16",
            "col_7": "支*****卡",
            "col_8": "1*****卡"
        },
        {
            "col_0": "48",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221006",
            "col_5": "-84.5",
            "col_6": "123585365.66",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "49",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221006",
            "col_5": "-22.39",
            "col_6": "123585343.27",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "50",
            "col_1": "电子汇入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221008",
            "col_5": "5000.00",
            "col_6": "123590343.27",
            "col_7": "电*****入",
            "col_8": "6*****星"
        },
        {
            "col_0": "51",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221012",
            "col_5": "-5",
            "col_6": "123590338.27",
            "col_7": "支*****华",
            "col_8": "1*****华"
        },
        {
            "col_0": "52",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221018",
            "col_5": "-1280.53",
            "col_6": "123589057.74",
            "col_7": "支*****红",
            "col_8": "1*****红"
        },
        {
            "col_0": "53",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221101",
            "col_5": "-638",
            "col_6": "123588419.74",
            "col_7": "支*****洋",
            "col_8": "1*****洋"
        },
        {
            "col_0": "54",
            "col_1": "短信服务费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221106",
            "col_5": "-2",
            "col_6": "123588417.74",
            "col_7": "账*****费",
            "col_8": "0*****0"
        },
        {
            "col_0": "55",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221106",
            "col_5": "-2637.00",
            "col_6": "123585780.74",
            "col_7": "网*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "56",
            "col_1": "电子汇入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221107",
            "col_5": "5300.00",
            "col_6": "123591080.74",
            "col_7": "电*****入",
            "col_8": "6*****星"
        },
        {
            "col_0": "57",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221110",
            "col_5": "-816",
            "col_6": "123590264.74",
            "col_7": "网*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "58",
            "col_1": "充值",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221110",
            "col_5": "-500",
            "col_6": "123589764.74",
            "col_7": "财*****户",
            "col_8": "1*****户"
        },
        {
            "col_0": "59",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221115",
            "col_5": "-75",
            "col_6": "123589689.74",
            "col_7": "支*****欣",
            "col_8": "1*****欣"
        },
        {
            "col_0": "60",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221115",
            "col_5": "-30",
            "col_6": "123589659.74",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "61",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221120",
            "col_5": "-500",
            "col_6": "123589159.74",
            "col_7": "网*****融",
            "col_8": "1*****融"
        },
        {
            "col_0": "62",
            "col_1": "电子汇入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221129",
            "col_5": "200000.00",
            "col_6": "123789159.74",
            "col_7": "转*****账",
            "col_8": "6*****力"
        },
        {
            "col_0": "63",
            "col_1": "电子汇入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221130",
            "col_5": "30000.00",
            "col_6": "123819159.74",
            "col_7": "转*****账",
            "col_8": "6*****力"
        },
        {
            "col_0": "64",
            "col_1": "电子汇入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221201",
            "col_5": "8000.00",
            "col_6": "123827159.74",
            "col_7": "电*****入",
            "col_8": "6*****星"
        },
        {
            "col_0": "65",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221203",
            "col_5": "-121.5",
            "col_6": "123827038.24",
            "col_7": "支*****）",
            "col_8": "1*****）"
        },
        {
            "col_0": "66",
            "col_1": "短信服务费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221206",
            "col_5": "-2",
            "col_6": "123827036.24",
            "col_7": "账*****费",
            "col_8": "0*****0"
        },
        {
            "col_0": "67",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221209",
            "col_5": "-22",
            "col_6": "123827014.24",
            "col_7": "支*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "68",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221209",
            "col_5": "-3",
            "col_6": "123827011.24",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "69",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221209",
            "col_5": "-5",
            "col_6": "123827006.24",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "70",
            "col_1": "银联入账",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221209",
            "col_5": "19555.84",
            "col_6": "123846562.08",
            "col_7": "代*****付",
            "col_8": "3*****司"
        },
        {
            "col_0": "71",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221211",
            "col_5": "-48.75",
            "col_6": "123846513.33",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "72",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221211",
            "col_5": "-2",
            "col_6": "123846511.33",
            "col_7": "支*****市",
            "col_8": "1*****市"
        },
        {
            "col_0": "73",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221211",
            "col_5": "-4",
            "col_6": "123846507.33",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "74",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221211",
            "col_5": "-42.82",
            "col_6": "123846464.51",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "75",
            "col_1": "电子汇入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221216",
            "col_5": "250190.85",
            "col_6": "124096655.36",
            "col_7": "手*****账",
            "col_8": "6*****桂"
        },
        {
            "col_0": "76",
            "col_1": "跨行转出",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221216",
            "col_5": "-480190.85",
            "col_6": "123616464.51",
            "col_7": "交*****险",
            "col_8": "9*****司"
        },
        {
            "col_0": "77",
            "col_1": "冲正",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221216",
            "col_5": "480190.85",
            "col_6": "124096655.36",
            "col_7": "交*****险",
            "col_8": "9*****司"
        },
        {
            "col_0": "78",
            "col_1": "跨行转出",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221216",
            "col_5": "-480190.85",
            "col_6": "123616464.51",
            "col_7": "保*****费",
            "col_8": "9*****司"
        },
        {
            "col_0": "79",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221216",
            "col_5": "-27",
            "col_6": "123616437.51",
            "col_7": "支*****权",
            "col_8": "1*****权"
        },
        {
            "col_0": "80",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221217",
            "col_5": "-8000.00",
            "col_6": "123608437.51",
            "col_7": "财*****账",
            "col_8": "1*****账"
        },
        {
            "col_0": "81",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221218",
            "col_5": "-180",
            "col_6": "123608257.51",
            "col_7": "财*****款",
            "col_8": "1*****款"
        },
        {
            "col_0": "82",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221220",
            "col_5": "-277",
            "col_6": "123607980.51",
            "col_7": "支*****洋",
            "col_8": "1*****洋"
        },
        {
            "col_0": "83",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221220",
            "col_5": "-1290.00",
            "col_6": "123606690.51",
            "col_7": "支*****栋",
            "col_8": "1*****栋"
        },
        {
            "col_0": "84",
            "col_1": "利息存入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221220",
            "col_5": "34.74",
            "col_6": "123606725.25",
            "col_7": "*****",
            "col_8": "*****"
        },
        {
            "col_0": "85",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221221",
            "col_5": "-3173.00",
            "col_6": "123603552.25",
            "col_7": "网*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "86",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221221",
            "col_5": "-45.88",
            "col_6": "123603506.37",
            "col_7": "网*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "87",
            "col_1": "银联入账",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221222",
            "col_5": "112734.73",
            "col_6": "123716241.1",
            "col_7": "代*****付",
            "col_8": "3*****司"
        },
        {
            "col_0": "88",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221223",
            "col_5": "-35",
            "col_6": "123716206.1",
            "col_7": "财*****公",
            "col_8": "1*****公"
        },
        {
            "col_0": "89",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221223",
            "col_5": "-6.5",
            "col_6": "123716199.6",
            "col_7": "财*****医",
            "col_8": "1*****医"
        },
        {
            "col_0": "90",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221223",
            "col_5": "-45.18",
            "col_6": "123716154.42",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "91",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221223",
            "col_5": "-73.7",
            "col_6": "123716080.72",
            "col_7": "财*****院",
            "col_8": "1*****院"
        },
        {
            "col_0": "92",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221223",
            "col_5": "-20",
            "col_6": "123716060.72",
            "col_7": "支*****卡",
            "col_8": "1*****卡"
        },
        {
            "col_0": "93",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221223",
            "col_5": "-19.48",
            "col_6": "123716041.24",
            "col_7": "支*****排",
            "col_8": "1*****排"
        },
        {
            "col_0": "94",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221223",
            "col_5": "-43.24",
            "col_6": "123715998",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "95",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221223",
            "col_5": "-22",
            "col_6": "123715976",
            "col_7": "财*****运",
            "col_8": "1*****运"
        },
        {
            "col_0": "96",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221224",
            "col_5": "-6",
            "col_6": "123715970",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "97",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221225",
            "col_5": "-37.9",
            "col_6": "123715932.1",
            "col_7": "财*****户",
            "col_8": "1*****户"
        },
        {
            "col_0": "98",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221225",
            "col_5": "-277",
            "col_6": "123715655.1",
            "col_7": "财*****账",
            "col_8": "1*****账"
        },
        {
            "col_0": "99",
            "col_1": "跨行转出",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221226",
            "col_5": "-62870.83",
            "col_6": "123652784.27",
            "col_7": "保*****费",
            "col_8": "9*****司"
        },
        {
            "col_0": "100",
            "col_1": "冲正",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221226",
            "col_5": "62870.83",
            "col_6": "123715655.1",
            "col_7": "保*****费",
            "col_8": "9*****司"
        },
        {
            "col_0": "101",
            "col_1": "跨行转出",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221226",
            "col_5": "-62870.83",
            "col_6": "123652784.27",
            "col_7": "保*****费",
            "col_8": "9*****司"
        },
        {
            "col_0": "102",
            "col_1": "冲正",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221226",
            "col_5": "62870.83",
            "col_6": "123715655.1",
            "col_7": "保*****费",
            "col_8": "9*****司"
        },
        {
            "col_0": "103",
            "col_1": "跨行转出",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221226",
            "col_5": "-62870.83",
            "col_6": "123652784.27",
            "col_7": "保*****费",
            "col_8": "9*****司"
        },
        {
            "col_0": "104",
            "col_1": "银联入账",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221226",
            "col_5": "11800.00",
            "col_6": "123664584.27",
            "col_7": "代*****付",
            "col_8": "3*****司"
        },
        {
            "col_0": "105",
            "col_1": "银联入账",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221226",
            "col_5": "15000.00",
            "col_6": "123679584.27",
            "col_7": "代*****付",
            "col_8": "3*****司"
        },
        {
            "col_0": "106",
            "col_1": "银联入账",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221226",
            "col_5": "18600.00",
            "col_6": "123698184.27",
            "col_7": "代*****付",
            "col_8": "3*****司"
        },
        {
            "col_0": "107",
            "col_1": "银联入账",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221226",
            "col_5": "4400.00",
            "col_6": "123702584.27",
            "col_7": "代*****付",
            "col_8": "3*****司"
        },
        {
            "col_0": "108",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221227",
            "col_5": "-30",
            "col_6": "123702554.27",
            "col_7": "支*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "109",
            "col_1": "银联入账",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221229",
            "col_5": "300000.00",
            "col_6": "124002554.27",
            "col_7": "代*****付",
            "col_8": "3*****司"
        },
        {
            "col_0": "110",
            "col_1": "电子汇入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221229",
            "col_5": "200000.00",
            "col_6": "124202554.27",
            "col_7": "转*****账",
            "col_8": "6*****力"
        },
        {
            "col_0": "111",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221229",
            "col_5": "-5000.00",
            "col_6": "124197554.27",
            "col_7": "财*****账",
            "col_8": "1*****账"
        },
        {
            "col_0": "112",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221230",
            "col_5": "-20",
            "col_6": "124197551.27",
            "col_7": "支*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "113",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221230",
            "col_5": "-7",
            "col_6": "124197544.27",
            "col_7": "支*****权",
            "col_8": "1*****权"
        },
        {
            "col_0": "114",
            "col_1": "电子汇入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221230",
            "col_5": "200000.00",
            "col_6": "124397544.27",
            "col_7": "转*****账",
            "col_8": "6*****力"
        },
        {
            "col_0": "115",
            "col_1": "跨行转出",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221230",
            "col_5": "-400000.00",
            "col_6": "123997544.27",
            "col_7": "保*****费",
            "col_8": "9*****司"
        },
        {
            "col_0": "116",
            "col_1": "跨行转出",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221230",
            "col_5": "-350094.85",
            "col_6": "123647449.42",
            "col_7": "保*****费",
            "col_8": "9*****司"
        },
        {
            "col_0": "117",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221231",
            "col_5": "-23",
            "col_6": "123647426.42",
            "col_7": "支*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "118",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221231",
            "col_5": "-7",
            "col_6": "123647419.42",
            "col_7": "支*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "119",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221231",
            "col_5": "-1837.00",
            "col_6": "123645582.42",
            "col_7": "财*****款",
            "col_8": "1*****款"
        },
        {
            "col_0": "120",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221231",
            "col_5": "-10.5",
            "col_6": "123645571.92",
            "col_7": "财*****司",
            "col_8": "1*****司"
        },
        {
            "col_0": "121",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20221231",
            "col_5": "-197",
            "col_6": "123645374.92",
            "col_7": "支*****站",
            "col_8": "1*****站"
        },
        {
            "col_0": "122",
            "col_1": "代收付",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230101",
            "col_5": "-15000.00",
            "col_6": "123630374.92",
            "col_7": "泰*****款",
            "col_8": "4*****司"
        },
        {
            "col_0": "123",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230102",
            "col_5": "-129",
            "col_6": "123630245.92",
            "col_7": "财*****驾",
            "col_8": "1*****驾"
        },
        {
            "col_0": "124",
            "col_1": "消费退货",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230102",
            "col_5": "129",
            "col_6": "123630374.92",
            "col_7": "财*****通",
            "col_8": "1*****通"
        },
        {
            "col_0": "125",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230102",
            "col_5": "-179.5",
            "col_6": "123630195.42",
            "col_7": "支*****彪",
            "col_8": "1*****彪"
        },
        {
            "col_0": "126",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230102",
            "col_5": "-7",
            "col_6": "123630188.42",
            "col_7": "支*****新",
            "col_8": "1*****新"
        },
        {
            "col_0": "127",
            "col_1": "电子汇入",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230103",
            "col_5": "4000.00",
            "col_6": "123634188.42",
            "col_7": "电*****入",
            "col_8": "6*****星"
        },
        {
            "col_0": "128",
            "col_1": "银联入账",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230105",
            "col_5": "19000.00",
            "col_6": "123653188.42",
            "col_7": "代*****付",
            "col_8": "3*****司"
        },
        {
            "col_0": "129",
            "col_1": "银联入账",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230105",
            "col_5": "69900.00",
            "col_6": "123723088.42",
            "col_7": "代*****付",
            "col_8": "3*****司"
        },
        {
            "col_0": "130",
            "col_1": "银联入账",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230105",
            "col_5": "22000.00",
            "col_6": "123745088.42",
            "col_7": "代*****付",
            "col_8": "3*****司"
        },
        {
            "col_0": "131",
            "col_1": "银联入账",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230105",
            "col_5": "626000.00",
            "col_6": "124371088.42",
            "col_7": "代*****付",
            "col_8": "3*****司"
        },
        {
            "col_0": "132",
            "col_1": "短信服务费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230106",
            "col_5": "-2",
            "col_6": "124371086.42",
            "col_7": "账*****费",
            "col_8": "0*****0"
        },
        {
            "col_0": "133",
            "col_1": "转账支取",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230109",
            "col_5": "-100000.00",
            "col_6": "124271086.42",
            "col_7": "中*****）",
            "col_8": "6*****梅"
        },
        {
            "col_0": "134",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230111",
            "col_5": "-8000.00",
            "col_6": "124263086.42",
            "col_7": "财*****账",
            "col_8": "1*****账"
        },
        {
            "col_0": "135",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230113",
            "col_5": "-10",
            "col_6": "124263076.42",
            "col_7": "支*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "8",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20220806",
            "col_5": "-300",
            "col_6": "123583192.12",
            "col_7": "支*****店",
            "col_8": "1*****店"
        },
        {
            "col_0": "134",
            "col_1": "消费",
            "col_2": "人民币元",
            "col_3": "钞",
            "col_4": "20230111",
            "col_5": "-8000.00",
            "col_6": "124263086.42",
            "col_7": "财*****账",
            "col_8": "1*****账"
        }
    ]
};
getData();

const importList = ref<any>([]);
const beforeUpload: UploadProps['beforeUpload'] = async (rawFile) => {
    importList.value = await analysisExcel(rawFile);
    return true;
};
const analysisExcel = (file: any) => {
    return new Promise(function (resolve, reject) {
        const reader = new FileReader();
        reader.onload = function (e: any) {
            const data = e.target.result;
            let datajson = XLSX.read(data, {
                type: 'binary',
            });

            const sheetName = datajson.SheetNames[0];
            const result = XLSX.utils.sheet_to_json(datajson.Sheets[sheetName]);
            resolve(result);
        };
        reader.readAsBinaryString(file);
    });
};

const handleMany = async () => {
    // 把数据传给服务器后获取最新列表，这里只是示例，不做请求
    const list = importList.value.map((item: any, index: number) => {
        return {
            id: index,
            name: item['姓名'],
            sno: item['学号'],
            class: item['班级'],
            age: item['年龄'],
            sex: item['性别'],
        };
    });
    tableData.value.push(...list);
};
</script>

<style scoped>
.handle-box {
    display: flex;
    margin-bottom: 20px;
}

.table {
    width: 100%;
    font-size: 14px;
}
.mr10 {
    margin-right: 10px;
}
</style>
